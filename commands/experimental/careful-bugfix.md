---
description: 段階的で慎重なバグ修正プロセス
---

# 慎重なバグ修正プロセス

## 報告された問題
$ARGUMENTS

## 必須フェーズ（順番厳守）

### フェーズ1: 問題理解と調査
1. **症状の正確な整理**
   - 何が起きているか
   - どの操作で発生するか
   - 期待される動作は何か

2. **関連コードの特定**
   - 該当機能のコントローラー/ビュー/コンポーネントをすべて特定
   - 関連するJavaScript/Stimulusコントローラーも確認
   - フォームが複数ある場合は全て把握

3. **現在の実装の完全理解**
   - 各ファイルを読んで処理フローを理解
   - パラメータの流れを追跡
   - データ型（Hash/String/Array等）を確認

### フェーズ2: 根本原因分析
1. **問題の本質を特定**
   - なぜこの現象が起きるのか
   - どのタイミングでデータが失われるのか
   - 複数のフォーム間のパラメータ受け渡しが正しいか

2. **影響範囲の把握**
   - この修正が他の機能に影響しないか
   - 類似の問題が他の画面でも起きないか

### フェーズ3: 修正計画立案
1. **最小限の修正方針を決定**
   - 既存の動作を壊さない最小の変更
   - Railsの慣例に従った実装
   - 型安全性を考慮した実装

2. **段階的修正ステップを計画**
   - 一度に一つの変更のみ
   - 各ステップで検証可能な単位

### フェーズ4: 段階的修正実行
1. **一つずつ修正**
   - 計画した順序で一つずつ実装
   - 各修正後にエラーチェック
   - エラーが出たら**必ず停止して原因分析**

2. **検証の徹底**
   - 修正後の動作確認
   - エラーログの確認
   - 期待通りの動作になっているか

### フェーズ5: 最終確認
1. **動作テスト**
   - 問題のシナリオを再現して解決確認
   - 他の機能が壊れていないか確認

## 絶対に守るべきルール
- **エラーが出たら必ず停止して原因分析し、その修正方法について、あなた以外の人から承認を得ること**
- **一度に複数の修正を行わない**
- **推測で修正せず、理解してから修正**
- **型やデータ構造を必ず確認してから処理**
- **Railsの慣例と現在のコードベースのパターンに従う**

## 禁止事項
- 急いで修正すること
- エラーが出ても続けて修正すること
- 問題を完全理解せずに修正すること
- 複数のアプローチを同時に試すこと